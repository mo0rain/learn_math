
```
N = p * q
phi = (q-1)*(p-1)

c = pow(m,e,N)
m = pow(c,d,N)

(n,e)公钥
(n,d)私钥

e*d 三 1 (mod phi)


```



# 例题


## 1

```python
from random import *
from secret import flag
from Crypto.Util.number import *

m = bytes_to_long(flag)
p = getPrime(1024)
q = getPrime(1024)
N = p * q

while True:
    gift = getrandbits(962)
    d0 = getrandbits(71)
    d1 = getrandbits(61)
    d = gift * d1 + d0

    if GCD(d, (p - 1) * (q - 1)) == 1:
        e = inverse(d, (p - 1) * (q - 1))
        break

c = pow(m, e, N)
print('N =', N)
print('e =', e)
print('c =', c)
print('gift =', gift)

# N = 18585217398105629125520924759282759601472213163515462958832167286648912562436568270748530670724611278444024967937907832925342928156387839726595139533045274068236864780358792455412545584018987095121564395436886051909454460422514503940942654809020720231521659944707498480941469933909406861494928698556981676589300055081512579612329460039392649583759219155945240430726252496308026256255235468146280742482534972808688254715010948609148667318667377939343935969198805397965496125133928135880606276399991945619292312197513135531160496695114548554015128298496027769403845355176404375426135201041998117821799087651660368421193
# e = 13672009168107200477462156112208442514985168632893719886476142032744815931914768435895052077709170766586838966459468461811169692523930861310621474737373374564590300129562077896081844753129282849436402385025140541892334906527927426068403247791955374081789801996347118540832792602708613707327329928433319118324681067932207086287932722004943433903570793263349808828070333867744625858067710502648628532516085798471052379056653552830618241007030115861452834490476628742330741879358367503028527345086392422312128693309360364053128218809235555663442820943643365892865522904816033914056964636401723539354079485710131503097847
# c = 16785316696969480068073808870892815764254210608554050318787929780573138718198175806778303405512120731096742074918396877088185801481992889862653559500841101775607125885787021903949351792567767228701087005709500960974182406152656179066979091552447505123517758748610921945935701365397903728464206428248229340317960062409910792956720301000614739646139836581793534376054976721997715068292596614818971959654786534989994764560916070552148352447468228657483665114554990371302659031209521236741474801603779357220611218095423745118002223100359872009462533379707888374891813159186625155073935922980472152732688220601009818024237
# gift = 28000886658277177794905821459720955162311292326109967577375774757672174307206826384389289633451490855820288453983352957979846063680138659913128491916513764374427147250059402991140985597705491424240488482558392624768260761030508027088757321332263071517304397314949001009907789380642603435952



```